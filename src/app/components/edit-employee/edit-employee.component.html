<div class="container-fluid py-4">
  <app-confirmation-popup/>
  <div class="d-flex justify-content-between align-items-center mb-4">
    <app-menu [askToLeave]="true" (onLeave)="attemptToLeave($event)" />
  </div>
  <div class="row justify-content-center">
    <div class="col-12 col-lg-8">

      <div class="card shadow-sm">
        <div class="card-body">

          <h1 class="h4 mb-4">Mitarbeiter anlegen</h1>

          <form (submit)="$event.preventDefault()">

            <!-- Vorname / Nachname -->
            <div class="row mb-1">
              <label class="col-sm-2 col-form-label" for="firstName">Vorname</label>
              <div class="col-sm-4">
                <input
                  id="firstName"
                  type="text"
                  class="form-control"
                  [ngClass]="{'is-invalid': employeeForm.firstName().invalid() && (employeeForm.firstName().touched() || attemptedSave())}"
                  [formField]="employeeForm.firstName"
                />
                <div class="invalid-feedback d-block validation-space">
                  @if (employeeForm.firstName().invalid() && (employeeForm.firstName().touched() || attemptedSave()) && employeeForm.firstName().errors().length > 0) {
                    {{ employeeForm.firstName().errors()[0].message }}
                  }
                </div>
              </div>

              <label class="col-sm-2 col-form-label" for="lastName">Nachname</label>
              <div class="col-sm-4">
                <input
                  id="lastName"
                  type="text"
                  class="form-control"
                  [ngClass]="{'is-invalid': employeeForm.lastName().invalid() && (employeeForm.lastName().touched() || attemptedSave())}"
                  [formField]="employeeForm.lastName"
                />
                <div class="invalid-feedback d-block validation-space">
                  @if (employeeForm.lastName().invalid() && (employeeForm.lastName().touched() || attemptedSave()) && employeeForm.lastName().errors().length > 0) {
                    {{ employeeForm.lastName().errors()[0].message }}
                  }
                </div>
              </div>
            </div>

            <!-- Adresse -->
            <div class="p-3 rounded bg-light mb-4">
              <h2 class="h6 mb-1 text-secondary">Adresse</h2>

              <!-- Straße -->
              <div class="row mb-1">
                <label class="col-sm-1 col-form-label" for="street">Straße</label>
                <div class="col-sm-11">
                  <input
                    id="street"
                    type="text"
                    class="form-control"
                    [ngClass]="{'is-invalid': employeeForm.street().invalid() && (employeeForm.street().touched() || attemptedSave())}"
                    [formField]="employeeForm.street"
                  />
                  <div class="invalid-feedback d-block validation-space">
                    @if (employeeForm.street().invalid() && (employeeForm.street().touched() || attemptedSave()) && employeeForm.street().errors().length > 0) {
                      {{ employeeForm.street().errors()[0].message }}
                    }
                  </div>
                </div>
              </div>

              <!-- PLZ / Ort -->
              <div class="row align-items-center">
                <label class="col-sm-1 col-form-label" for="postcode">PLZ</label>
                <div class="col-sm-4">
                  <input
                    id="postcode"
                    type="text"
                    class="form-control"
                    [ngClass]="{'is-invalid': employeeForm.postcode().invalid() && (employeeForm.postcode().touched() || attemptedSave())}"
                    [formField]="employeeForm.postcode"
                  />
                  <div class="invalid-feedback d-block validation-space">
                    @if (employeeForm.postcode().invalid() && (employeeForm.postcode().touched() || attemptedSave()) && employeeForm.postcode().errors().length > 0) {
                      {{ employeeForm.postcode().errors()[0].message }}
                    }
                  </div>
                </div>

                <label class="col-sm-1 col-form-label" for="city">Ort</label>
                <div class="col-sm-6">
                  <input
                    id="city"
                    type="text"
                    class="form-control"
                    [ngClass]="{'is-invalid': employeeForm.city().invalid() && (employeeForm.city().touched() || attemptedSave())}"
                    [formField]="employeeForm.city"
                  />
                  <div class="invalid-feedback d-block validation-space">
                    @if (employeeForm.city().invalid() && (employeeForm.city().touched() || attemptedSave()) && employeeForm.city().errors().length > 0) {
                      {{ employeeForm.city().errors()[0].message }}
                    }
                  </div>
                </div>
              </div>
            </div>

            <!-- Telefon -->
            <div class="row mb-1">
              <label class="col-sm-2 col-form-label" for="phone">Telefon</label>
              <div class="col-sm-10">
                <input
                  id="phone"
                  type="tel"
                  class="form-control"
                  [ngClass]="{'is-invalid': employeeForm.phone().invalid() && (employeeForm.phone().touched() || attemptedSave())}"
                  [formField]="employeeForm.phone"
                />
                <div class="invalid-feedback d-block validation-space">
                  @if (employeeForm.phone().invalid() && (employeeForm.phone().touched() || attemptedSave()) && employeeForm.phone().errors().length > 0) {
                    {{ employeeForm.phone().errors()[0].message }}
                  }
                </div>
              </div>
            </div>


            <div class="p-3 rounded bg-light mb-1">
              <app-qualification-list
                [qualifications]="employee().skillSet"
                [maxBodyHeight]="'250px'"
                (newQualificationEvent)="onNewQualificationEvent($event)"
                (selectQualificationEvent)="onSelectQualification($event)"
                (deleteQualificationEvent)="onDeleteQualification($event)"
              />
            </div>

            <!-- Actions -->
            <div class="d-flex justify-content-end gap-2">
              <button
                type="button"
                class="btn btn-outline-secondary"
                (click)="delete()">
                Löschen
              </button>

              <button
                type="button"
                class="btn btn-outline-secondary"
                (click)="cancel()">
                Test
              </button>

              <button
                type="button"
                class="btn btn-primary"
                (click)="save()"
                [disabled]="this.canSave()">
                Speichern
              </button>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>
</div>
